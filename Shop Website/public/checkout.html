<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Guest Checkout - MystiKraft</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="text-center p-4">
    <h1>MystiKraft</h1>
  </header>

  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <a class="navbar-brand" href="index.html"><img src="images/Logo/Logo.jpg" alt="MystiKraft Logo" style="height: 40px;"> MystiKraft</a>
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="shop.html">Shop</a></li>
        <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
        <li class="nav-item"><a class="nav-link" href="search.html">Search</a></li>
        <li class="nav-item"><a class="nav-link active" href="checkout.html">üõí Checkout</a></li>
      </ul>
    </div>
  </nav>

  <main class="container my-4">
    <h2 class="text-center mb-4">üõí U2 Task 4: Guest Checkout (No Account Required)</h2>
    
    <div class="alert alert-info">
      <h5>üìã Demo Checkout Process</h5>
      <p>This is a demonstration of the guest checkout functionality. Fill out the form below to simulate placing an order.</p>
    </div>
    
    <div class="row">
      <div class="col-md-8">
        <div class="card">
          <div class="card-header">
            <h5>üë§ Customer Information</h5>
          </div>
          <div class="card-body">
            <form id="checkoutForm">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="firstName" class="form-label">First Name *</label>
                  <input type="text" class="form-control" id="firstName" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="lastName" class="form-label">Last Name *</label>
                  <input type="text" class="form-control" id="lastName" required>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="email" class="form-label">Email *</label>
                  <input type="email" class="form-control" id="email" required>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="phone" class="form-label">Phone</label>
                  <input type="tel" class="form-control" id="phone">
                </div>
              </div>
              <h6 class="mt-4">üè† Shipping Address</h6>
              <div class="mb-3">
                <label for="street" class="form-label">Street Address *</label>
                <input type="text" class="form-control" id="street" required>
              </div>
              <div class="row">
                <div class="col-md-4 mb-3">
                  <label for="city" class="form-label">City *</label>
                  <input type="text" class="form-control" id="city" required>
                </div>
                <div class="col-md-4 mb-3">
                  <label for="state" class="form-label">State *</label>
                  <input type="text" class="form-control" id="state" required>
                </div>
                <div class="col-md-4 mb-3">
                  <label for="zipCode" class="form-label">ZIP Code *</label>
                  <input type="text" class="form-control" id="zipCode" required>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="card">
          <div class="card-header">
            <h5>üì¶ Order Summary</h5>
          </div>
          <div class="card-body">
            <div id="cartItems">
              <div class="d-flex justify-content-between mb-2">
                <span>Nike Air Max x1</span>
                <span>$120.00</span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <span>Ultraboost x1</span>
                <span>$220.00</span>
              </div>
            </div>
            <hr>
            <div class="d-flex justify-content-between">
              <strong>Total:</strong>
              <strong>$340.00</strong>
            </div>
            <button class="btn btn-success w-100 mt-3" onclick="processCheckout()">
              ‚úÖ Complete Guest Checkout
            </button>
            <button class="btn btn-secondary w-100 mt-2" onclick="testCartAPI()">
              üß™ Test Cart API
            </button>
          </div>
        </div>
      </div>
    </div>

  </main>

  <footer class="text-center p-3 mt-5">
    <p>&copy; 2025 MystiKraft</p>
    <p>Last Updated: May 5, 2025</p>
    <p>Contact: <a href="mailto:support@mystikraft.com" class="orange-link">support@mystikraft.com</a></p>
  </footer>

  <script>
    // Test Cart API functionality
    async function testCartAPI() {
      try {
        console.log('üß™ Testing U2 Task 4 Cart API...');
        
        // Test 1: Get cart
        const cartResponse = await fetch('/api/cart');
        const cart = await cartResponse.json();
        console.log('‚úÖ Cart API Test 1 - Get Cart:', cart);
        
        // Test 2: Add to cart (using first product ID from seeded data)
        const addToCartResponse = await fetch('/api/cart', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ productId: '507f1f77bcf86cd799439011' })
        });
        const addResult = await addToCartResponse.json();
        console.log('‚úÖ Cart API Test 2 - Add to Cart:', addResult);
        
        alert('üß™ U2 Task 4 Cart API Tests Completed!\n\nCheck console for detailed results.\n\nFeatures tested:\n‚úÖ Get Cart\n‚úÖ Add to Cart\n‚úÖ Cart Management');
        
      } catch (error) {
        console.error('‚ùå Cart API Test failed:', error);
        alert('‚ùå Cart API Test failed! Check console for errors.');
      }
    }

    // Process checkout
    async function processCheckout() {
      try {
        const form = document.getElementById('checkoutForm');
        if (!form.checkValidity()) {
          form.reportValidity();
          return;
        }

        const customerInfo = {
          firstName: document.getElementById('firstName').value,
          lastName: document.getElementById('lastName').value,
          email: document.getElementById('email').value,
          phone: document.getElementById('phone').value,
          address: {
            street: document.getElementById('street').value,
            city: document.getElementById('city').value,
            state: document.getElementById('state').value,
            zipCode: document.getElementById('zipCode').value,
            country: 'Australia'
          }
        };

        // Simulate order creation (since we don't have real cart items)
        const mockOrder = {
          orderNumber: 'ORD-' + Date.now() + '-DEMO',
          customerInfo: customerInfo,
          items: [
            { name: 'Nike Air Max', price: 120, quantity: 1 },
            { name: 'Ultraboost', price: 220, quantity: 1 }
          ],
          total: 340,
          status: 'pending',
          createdAt: new Date()
        };

        // Simulate API call delay
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        alert(`üéâ U2 Task 4: Guest Checkout Completed!\n\nOrder Number: ${mockOrder.orderNumber}\nCustomer: ${customerInfo.firstName} ${customerInfo.lastName}\nEmail: ${customerInfo.email}\nTotal: $${mockOrder.total}\nStatus: ${mockOrder.status}\n\n‚úÖ No account required!\n‚úÖ Guest checkout successful!`);
        
        // Reset form
        form.reset();
        
      } catch (error) {
        console.error('Checkout error:', error);
        alert('‚ùå Error processing checkout. Please try again.');
      }
    }

    // Add demo data to form
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('firstName').value = 'John';
      document.getElementById('lastName').value = 'Doe';
      document.getElementById('email').value = 'john.doe@example.com';
      document.getElementById('phone').value = '0412345678';
      document.getElementById('street').value = '123 Main Street';
      document.getElementById('city').value = 'Melbourne';
      document.getElementById('state').value = 'VIC';
      document.getElementById('zipCode').value = '3000';
    });
  </script>
</body>
</html>
