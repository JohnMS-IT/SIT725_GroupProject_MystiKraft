<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Checkout - MystiKraft</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/dark-mode.css">
  <script src="js/dark-mode.js"></script>
  <style>
    .user-welcome {
      background-color: #e8f5e9;
      border-left: 4px solid #4caf50;
      padding: 15px;
      margin-bottom: 20px;
    }
    .order-item {
      border-bottom: 1px solid #e0e0e0;
      padding: 10px 0;
    }
    .order-item:last-child {
      border-bottom: none;
    }
    .order-summary-card {
      position: sticky;
      top: 20px;
    }
    .section-header {
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #e0e0e0;
    }
    .auto-filled {
      background-color: #f5f5f5;
    }
  </style>
</head>
<body>
  <header class="center-align section">
    <h1>MystiKraft</h1>
  </header>

  <!-- Navbar -->
  <nav class="white">
    <div class="nav-wrapper container">
      <a href="index.html" class="brand-logo">
        <img src="images/Logo/Logo.jpg" alt="MystiKraft Logo" style="height: 40px; vertical-align: middle;">
        MystiKraft
      </a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li><a href="index.html">Home</a></li>
        <li><a href="shop.html">Shop</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li><a href="search.html">Search</a></li>
        <li class="active">
          <a href="cart.html">
            My Cart <span id="cart-count" class="new badge black">0</span>
          </a>
        </li>
        <li id="authLinks"><a href="#loginModal" class="modal-trigger">Login</a></li>
        <li id="userMenu" class="hide">
          <a class="dropdown-trigger" href="#!" data-target="dropdown1"><span id="userEmail">User</span><i
              class="material-icons right">arrow_drop_down</i></a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- User Dropdown -->
  <ul id="dropdown1" class="dropdown-content">
    <li><a href="profile.html">Profile</a></li>
    <li><a href="#" id="logoutBtn">Logout</a></li>
  </ul>

  <!-- Login/Register Modal -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <h4>Login</h4>
      <form id="loginForm">
        <div class="input-field">
          <input type="email" id="email" required>
          <label for="email">Email</label>
        </div>
        <div class="input-field">
          <input type="password" id="password" required>
          <label for="password">Password</label>
        </div>
        <button type="submit" class="btn waves-effect waves-light">Login</button>
        <button type="button" class="btn-flat" id="showRegister">Register</button>
      </form>

      <form id="registerForm" class="hide">
        <div class="input-field">
          <input type="email" id="registerEmail" required>
          <label for="registerEmail">Email</label>
        </div>
        <div class="input-field">
          <input type="password" id="registerPassword" required>
          <label for="registerPassword">Password</label>
        </div>
        <div class="input-field">
          <input type="password" id="confirmPassword" required>
          <label for="confirmPassword">Confirm Password</label>
        </div>
        <button type="submit" class="btn waves-effect waves-light">Register</button>
        <button type="button" class="btn-flat" id="showLogin">Login</button>
      </form>
    </div>
  </div>

  <main class="container section">
    <h4 class="center-align">Checkout</h4>
    
    <div class="user-welcome">
      <div class="row valign-wrapper">
        <div class="col s1">
          <i class="material-icons">check_circle</i>
        </div>
        <div class="col s11">
          <span>Welcome back! Your saved information has been automatically filled. You can review and edit if needed.</span>
        </div>
      </div>
    </div>
    
    <div class="row">
      <!-- Customer Information -->
      <div class="col s12 m8">
        <div class="card">
          <div class="card-content">
            <span class="card-title">Customer Information</span>
            <form id="checkoutForm">
              <div class="row">
                <div class="input-field col s12 m6">
                  <input id="firstName" type="text" class="validate" required>
                  <label for="firstName">First Name *</label>
                </div>
                <div class="input-field col s12 m6">
                  <input id="lastName" type="text" class="validate" required>
                  <label for="lastName">Last Name *</label>
                </div>
              </div>
              <div class="row">
                <div class="input-field col s12 m6">
                  <input id="checkoutEmail" type="email" class="validate" required>
                  <label for="checkoutEmail">Email *</label>
                </div>
                <div class="input-field col s12 m6">
                  <input id="phone" type="tel">
                  <label for="phone">Phone</label>
                </div>
              </div>
              
              <div class="section-header">
                <h6>Shipping Address</h6>
              </div>
              
              <div class="input-field">
                <input id="street" type="text" class="validate" required>
                <label for="street">Street Address *</label>
              </div>
              <div class="row">
                <div class="input-field col s12 m4">
                  <input id="city" type="text" class="validate" required>
                  <label for="city">City *</label>
                </div>
                <div class="input-field col s12 m4">
                  <input id="state" type="text" class="validate" required>
                  <label for="state">State *</label>
                </div>
                <div class="input-field col s12 m4">
                  <input id="zipCode" type="text" class="validate" required>
                  <label for="zipCode">ZIP Code *</label>
                </div>
              </div>
              <div class="row">
                <div class="input-field col s12">
                  <input id="country" type="text" class="validate" value="Australia" required>
                  <label for="country">Country</label>
                </div>
              </div>

              <!-- 添加支付方法部分 -->
              <div class="section-header">
                <h6>Payment Method</h6>
              </div>
              
              <div class="row">
                <div class="input-field col s12">
                  <select id="paymentMethod" name="paymentMethod" required>
                    <option value="" disabled selected>Choose your payment method</option>
                    <option value="credit_card">Credit Card</option>
                    <option value="cash_on_delivery">Cash on Delivery</option>
                  </select>
                  <label>Preferred Payment Method *</label>
                </div>
              </div>
              
              <!-- Credit Card Information (shown only when credit card is selected) -->
              <div id="creditCardSection" class="hide">
                <div class="row">
                  <div class="input-field col s12">
                    <input id="cardHolderName" name="cardHolderName" type="text" class="validate">
                    <label for="cardHolderName">Cardholder Name</label>
                  </div>
                </div>
                <div class="row">
                  <div class="input-field col s12 m8">
                    <input id="cardNumber" name="cardNumber" type="text" class="validate" maxlength="16">
                    <label for="cardNumber">Card Number</label>
                  </div>
                  <div class="input-field col s12 m4">
                    <input id="expiryDate" name="expiryDate" type="text" class="validate" placeholder="MM/YY">
                    <label for="expiryDate">Expiry Date</label>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      
      <!-- Order Summary -->
      <div class="col s12 m4">
        <div class="card order-summary-card">
          <div class="card-content">
            <span class="card-title">Order Summary</span>
            <div id="order-items">
              <!-- Dynamic cart items will be loaded here -->
              <div class="center-align">
                <div class="preloader-wrapper small active">
                  <div class="spinner-layer spinner-green-only">
                    <div class="circle-clipper left">
                      <div class="circle"></div>
                    </div><div class="gap-patch">
                      <div class="circle"></div>
                    </div><div class="circle-clipper right">
                      <div class="circle"></div>
                    </div>
                  </div>
                </div>
                <p>Loading cart items...</p>
              </div>
            </div>
            <div class="divider"></div>
            
            <!-- Coupon Code Section -->
            <div style="margin-top: 15px;">
              <div class="input-field" style="margin-bottom: 10px;">
                <input type="text" id="coupon-code" placeholder="Enter coupon code">
                <label for="coupon-code">Discount Code</label>
              </div>
              <button id="btn-apply-coupon" class="btn-small black waves-effect waves-light" style="width: 100%;">
                Apply Coupon
              </button>
              <div id="coupon-message" style="margin-top: 10px; display: none;"></div>
            </div>
            
            <div class="divider" style="margin-top: 15px;"></div>
            
            <div class="order-total" style="margin-top: 15px;">
              <div id="order-subtotal" style="display: none;">
                <p>Subtotal: <span id="subtotal-amount">$0.00</span></p>
              </div>
              <div id="order-discount" style="display: none; color: #4caf50;">
                <p>Discount: -<span id="discount-amount">$0.00</span></p>
              </div>
              <h6>Total: <strong id="order-total-amount">$0.00</strong></h6>
            </div>
            <div class="card-action" style="display: flex; flex-direction: column;">
              <button id="btn-place-order" class="btn green waves-effect waves-light" disabled>
                Complete Order
              </button>
              <a href="cart.html" class="btn-flat waves-effect center-align" style="margin-top: 10px;">Back to Cart</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="page-footer black">
    <div class="container center-align">
      <p>© 2025 MystiKraft</p>
      <p>Contact: <a href="mailto:support@mystikraft.com" class="orange-link">support@mystikraft.com</a></p>
    </div>
  </footer>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/cart-count.js"></script>
  <script src="js/checkout.js"></script>
</body>
</html>